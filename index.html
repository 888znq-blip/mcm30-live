<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>DNA CORE - LIVE CLOUD SYNC</title>
</head>
<body>
<div id="ui">
    <div style="display:flex;gap:12px;align-items:center"><h1 style="font-size:13px;">DNA CORE</h1><span id="status" class="status">SYNCING...</span></div>
    <button id="followBtn">FOLLOWING</button>
</div>
<canvas id="matrixCanvas"></canvas>
<div id="streakPanel"></div><div id="indexPanel"></div><div id="reversalPanel"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
    projectId: "mcm30-db-fe9da",
    databaseURL: "https://mcm30-db-fe9da-default-rtdb.firebaseio.com"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// DNA Variables
let matrixData = {}, currentColumn = 0, cameraX = 0, isFollowing = true;
const CELL_W = 68, TOTAL_ROWS = 30, MAX_COLS = 14400;

// Listen to Firebase
onValue(ref(db, 'matrixData'), (snapshot) => {
    const data = snapshot.val();
    if (data) {
        matrixData = data;
        const cols = Object.keys(matrixData).map(Number);
        currentColumn = Math.max(...cols);
        document.getElementById('status').innerText = "LIVE CLOUD";
        updatePanels(); 
        if (isFollowing) jumpToCurrent();
    }
});

// [Include your original updatePanels(), draw(), and modal functions here]
// IMPORTANT: Remove the original connect() function as it is no longer needed.
</script>
</body>
</html>
